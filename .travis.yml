sudo: required
dist: xenial
services:
- docker
env:
  global:
  - PKGFORGE_STATEFILE=/tmp/pkgforge
  - BUCKET=akerl-snstoslack
  - PATH=$HOME/.local/bin:$PATH
  - secure: fS/Eh9tXuH2V7hROhau6wgG3ziFqCTnzO1M33LcfKzzv65JHOChFT/enTBTAnSQznUDyQYOV8R1vDlQ79E6lxhJ8h3HqZVRK+GRO/uEKzMyVQyEnG9O0/ENJgX7cN8Du86WUsv2ddQMEvrJhgA98rid/Mg4WQ7HvrlFOcBpNrW+P7mx7d3hIX54HIpOC+goPc5rQ7JhLAkJqctpfoMKZgFlgq/gFG1GZ9uquN/iDGptIkEs5ohDTj+uJxbHIS1F66A+Jw1q1bmCgkIyPzLmzXct+/JjloQy7RmbFbQKQH2q3jrFG/7dLea1t4IkpIaDGuisEYjlInLRX516fZe04SDJUWoeJ8lmhP4a/X4Nhz5/QnVp9t6i6LVxjQ92p9al2VBM7N1RZpLZWEGb1B23JV6Wt3/j8B9wbYE4vL9G1pCECAXZOo91JlO0R+2U0Y0rdiQ2FCVQYOYSB+ubbkmnrrf1f1MFkkfsks0baKcY4rGkzcByyvWkykDyyrIodu4dvPqbpiDF0eLnIK1IXDVPdP4DTG/VunslCJTpNTYdzghbzhn5sxC0oUVuiVGg5VMz+zRqFw/L4CH2PNkE3JkZu8A3gefnVXauUMxnE8ZhcpFxLT2WSlvyDqiSHe02RqoJ0ZNxqWs6OUbtJZp/GzVuu1NCDNjQDQqK9VtJKG3GF7Rg=
  - secure: V6N8Ny3VtcdMsm7kqQKGduSIHfzKW3zbAFzsj/xn6dFtapEmgI4Rtyq0nba05xOtzJosZQSNQZV2Ccg5uiUpHHYJSeR30sYM3nUkR4qthEyM9wclQXhNhrSYDwLxQMq7fq6PTbqT1I5FunEK6thNjhykVTCqFgcQKV0BX+Q1XLL3Hpe7l6idYcKob018WJAw5aBf/JPTvy4dLQWHk6ckp960pq2tsY/KbTLo7Mr6bCwCwFoVI/0xqej1DKdtenUMlUFkd2y8geEGnzCvPj866zkITVFCNUfRzyNopEslosG5NZWdWiY6uoRwuLCSUnLUNXzp0cd59K4O6ugwG8SSauU7g2pnmC/izqriya/hMotCwniSi8v9+0uAnZd35FzgAomNTZy3m2kBBKV2JpG9fUQtaaSt+aDdJkrK85i7wJEpe1JMM7tpHyKORrOw/UW0VtwlEYUnJwuMOBbOinC51e/xK7HaLUsNtE6aAivg9JGqM/EA/ucR903WFPF/8ezoWTtv+orFoyZF34M2intWfo1zLjG4pvHqEpxdwUr3cEatZuPSSqu/K0s28VJdqi0SmtY45FxHFUp3X+EL0t0Ad1ADn4KViZd38Z64KUQovZYspdWslDFdNO5d9QU/CACBBCMhb75jMd4VRBnBRSKqwaNRc5sRu+2mjeoJQuEYVKc=
  - secure: GFT4SKR5+SEI5xpi6Bkq1ti1LL9KDPIp/2VTYACtCMJKAT+JiirrC3ZLQqMTUoyTRWIAXxakcKEwL4uYCcNwZS+0QkRKRhpuBuYO/Ga9iYTLt8IZt5/kkrnWQ5iouy4Bqtih9XpB2QH+2ZN5YygI0cPoOMspBQg99RAjurrtzZuk1rS9YD+p0z7eE5SAXEG7FAe9DOBrkktcqZ6Bnd7TkJ8IUzsmXo+n2LmzET4FnqZqVmckuoFKxTUHbH5WiFq6IImCOQC9qP8lDO9d/+aZPCDr97mJz3bo1VrmT2I56GzLkfMeAlATf3I0D0ZERKafIDecKDFpUW/Bsy4xH0qX8BARxImn2FbL26nXgxs1vC7pzCeCuc7BEeVpQvm9E+++ZD3jnzk5aIXbBlFPBRd2CJHypWyrDOijvPdB6IX06R2DmJxMU2Oh2aOU+IWFUogiDm52zNU7WsLJUDcfnDYXEBPE6yxAKtY7C5vhB9Uof8RpgJJ67NfwkoUhi7UlzxKtk7rm6Eccrteppm8hGI3oK6agGwtXNMnLgjRXenOPNHSwnZkR2KfcyurdK9dkPF2xW5isQnLnrg9OjjmYxg82DG+UpKYqmMQcq6FCls5zQl7juUk3ddERR7fly7fW7KECyi5ROqZp7mXRgV4dwq7yaJWxf9hKnXizuN5E7Mr8qsU=
before_install:
- pip install --user awscli
script: make
deploy:
  provider: script
  script: make release && aws s3 cp pkg/payload.zip "s3://$BUCKET/$TRAVIS_TAG.zip"
  skip_cleanup: true
  on:
    tags: true
notifications:
  email: false
  slack:
    secure: CIWPjeq4MO5/24XqrZTd6u/OHl0OwQOklsJge2UnXVE2KtRLSemA+uvtSCtxTdyoer3TOEoQJ9nFbTp1mdeHqpNPMqhQ0lbn7usrPxWEnwVVmDi1/7tAgmrgt+upYPnXF5e5xPcmCWxuCGoPOKzKWVYpGlWeTiO7fcyDNfL0D3GQ8YuYjO+i144Nlk9aAFoSBe9V6eqsoU1AiTaBxW9dKTEMxRI1Bg1TT4VjcuzpWIuLp73GKA5Itbrr0Se3FUyFmkuynxCtivAb/SBQ2b6uKO8R/DG8I5G++HUohPiTNaZQDRcc2QRR1dBanwBHOKYEIEPRVaTaY1ncnMqWoLnduw05UL6iqE7AagLxl+3v+3rFin6omz4IhO6xtyivUzr6FmAgohbAeCBShDDZ60Bd4GcLGWlQsrcD9IfVIZE3sTh3t9a4PXguL+A6TFl6NvCBo+41Zjv75wvd+VbwwkTMNb7HXgmCBaP4WWsO1P492C1Aoah2yRhRpROELFhU/8ZnGhGPD4ii21Bx7Ou4P+fv2vQoWbIP0jbxqhvao2YR1cLLfqxY4k2BNn1wvvrkmLL5spXoQhYqgsSUUQkWHt02tzLM7iCTRHB5wLTmyLb5d5nbqfw9Ik5yYC1w+pMSI1f9r4KXYlSckHzY3JnvnCVHhNPpYtv2DMy1QQNtEx0L7h4=
